<div class="header">
  <div class="container-header-dashboard container">
  </div>
</div>
<div class="container">
  <h1>Mes conversations</h1>
  <div class="d-flex align-items-start row">
    <div class="col-4">
      <div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
        <% @chatrooms.each do |chatroom| %>
          <button class="nav-link <%= 'active' if chatroom.professional.first_name == params[:query] %>" id="v-pills-<%= chatroom.id %>-tab" data-bs-toggle="pill" data-bs-target="#v-pills-<%= chatroom.id %>" type="button" role="tab" aria-controls="v-pills-<%= chatroom.id %>" aria-selected="true"><%= chatroom.professional.first_name %></button>
        <% end %>
      </div>
    </div>
    <div class="col-8">
      <div class="tab-content" id="v-pills-tabContent">
        <% @chatrooms.each do |chatroom| %>
          <div class="tab-pane fade show <%= 'active' if chatroom.professional.first_name == params[:query] %>" id="v-pills-<%= chatroom.id %>" role="tabpanel" aria-labelledby="v-pills-<%= chatroom.id %>-tab" tabindex="0" data-controller="update-messages" data-update-messages-chatroom-id-value="<%= chatroom.id %>">
            <div class="messages" data-update-messages-target="list">
              <% chatroom.messages.each do |message| %>
                <%= render "messages/message", message: message %>
              <% end %>
            </div>
            <%= simple_form_for [chatroom, @message],
            html: {class: "d-flex", data: { update_messages_target: "form", action: "submit->update-messages#send" }} do |f|
            %>
              <%= f.input :content,
                label: false,
                placeholder: "Message ##{chatroom.professional.first_name}",
                value: params[:content],
                input_html: { data: { update_messages_target: "content" }},
                wrapper_html: {class: "flex-grow-1" }
              %>
              <%= f.submit "Envoyer", class: "btn btn-primary mb-3" %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
